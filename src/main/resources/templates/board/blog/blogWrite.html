<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>DEVLOG - 글 작성</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://uicdn.toast.com/editor/latest/toastui-editor.min.css" />

    <link rel="stylesheet" th:href="@{/css/common/common.css}">
    <link rel="stylesheet" th:href="@{/css/common/notification.css}" />
    <link rel="stylesheet" th:href="@{/css/board/blog/blogWrite.css}">
</head>

<body>

    <div th:replace="~{common/header :: header}"></div>

    <main class="write-container">

        <input type="hidden" id="boardNo" th:value="${post != null ? post.boardNo : ''}">
        <input type="hidden" id="initialContent" th:value="${post != null ? post.boardContent : ''}">
        <input type="hidden" id="initialTags" th:value="${post != null ? #strings.listJoin(post.tagList, ',') : ''}">

        <section class="title-section">
            <input type="text" class="input-title" id="titleInput" placeholder="제목을 입력하세요."
                th:value="${post != null ? post.boardTitle : ''}">

            <div class="divider"></div>

            <div class="tag-wrapper">
                <div id="tagList" class="tag-list"></div>
                <input type="text" class="input-tag" id="tagInput" placeholder="# 태그 입력 (쉼표로 등록)">
            </div>
        </section>

        <section class="thumbnail-section">
            <div class="thumbnail-upload-box" onclick="document.getElementById('thumbInput').click()">
                <img id="thumbPreview"
                    th:src="${post != null and post.thumbnailUrl != null ? post.thumbnailUrl : 'https://cdn-icons-png.flaticon.com/512/3342/3342137.png'}"
                    alt="썸네일 미리보기">
                <div class="upload-hint">
                    <i class="fa-solid fa-camera"></i>
                    <span>대표 이미지(썸네일) 등록</span>
                </div>
            </div>
            <input type="file" id="thumbInput" accept="image/*" style="display:none;">
            <input type="hidden" id="thumbnailUrl" th:value="${post != null ? post.thumbnailUrl : ''}">
        </section>

        <div class="spell-check-area">
            <span>스마트 맞춤법 검사</span>
            <label class="toggle-switch">
                <input type="checkbox" id="spellToggle">
                <span class="slider round"></span>
            </label>
        </div>

        <div id="editor"></div>

        <section class="bottom-section">

            <div class="paid-content-settings">
                <div class="setting-title">
                    <i class="fa-solid fa-crown crown-icon"></i> 유료 콘텐츠 발행
                </div>
                <p class="setting-desc">
                    유료 콘텐츠는 구매자에게 직접적인 가치를 전달하는 중요한 제품입니다.<br>
                    자세한 내용을 확인하신 후 발행을 진행해 주세요.
                    <a href="#" id="btnOpenModal">자세히 알아보기</a>
                </p>

                <div class="radio-group">
                    <label class="radio-label">
                        <input type="radio" name="content-type" value="free"
                            th:checked="${post == null or post.isPaid == 'N'}">
                        <span class="radio-custom"></span>
                        일반 콘텐츠로 발행합니다
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="content-type" value="paid"
                            th:checked="${post != null and post.isPaid == 'Y'}">
                        <span class="radio-custom"></span>
                        유료 콘텐츠로 발행합니다
                    </label>
                </div>

                <div class="price-input-wrapper" id="priceWrapper">
                    <span class="price-label">판매 금액</span>
                    <div class="input-with-icon">
                        <i class="fa-solid fa-coins bean-icon"></i>
                        <input type="number" id="priceInput" placeholder="0" min="0"
                            th:value="${post != null ? post.price : ''}"
                            th:disabled="${post == null or post.isPaid == 'N'}">
                        <span class="unit">콩</span>
                    </div>
                </div>
            </div>

            <div class="action-buttons">
                <button class="btn-exit" onclick="history.back()">← 나가기</button>
                <div class="right-buttons">
                    <button class="btn-draft">임시저장</button>
                    <button class="btn-publish" id="btnSave" 
                            th:text="${post != null and post.tempFl == 'N' ? '수정하기' : '발행하기'}">
                            발행하기
                    </button>
                </div>
            </div>
        </section>
    </main>

    <div id="guidelineModal" class="modal-overlay">
        <div class="modal-window">
            <div class="modal-header">
                <h3>📘 유료 콘텐츠 발행 회원 안내사항 (가이드라인)</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="guideline-item">
                    <h4>1. 콘텐츠 품질 및 검수 관련 안내</h4>
                    <p>유료 콘텐츠는 무료 게시물보다 기대치가 높습니다. 독자에게 명확한 가치를 제공할 수 있도록 아래 사항을 준비해주세요.</p>
                    <ul>
                        <li>내용의 정확성, 저작권 준수 여부를 반드시 확인해주세요.</li>
                        <li>오탈자, 문장 구조, 레이아웃 체크 등 기본 검수는 작가님 책임입니다.</li>
                        <li>인용·참고자료가 있다면 출처를 명확히 명시해주세요.</li>
                        <li>사실 기반 콘텐츠일 경우 데이터·근거를 제시하면 신뢰도가 높아집니다.</li>
                    </ul>
                    <h4>2️. 저작권 및 콘텐츠 사용권 안내</h4>
                    <p>업로드한 모든 콘텐츠에 대한 저작권은 작가님에게 있습니다.</p>
                    <ul>
                        <li>단, 유료 발행 시 서비스 내에서 판매·노출·홍보할 수 있는 사용권이 자동 부여됩니다.</li>
                        <li>타인의 이미지, 음악, 글을 사용하실 경우 반드시 라이선스를 확보해 주세요.</li>
                        <li>저작권 침해 신고가 접수될 경우 판매가 즉시 중지될 수 있습니다.</li>
                    </ul>
                    <h4>3️. 환불 정책 및 책임 범위</h4>
                    <p>구매 후 단순 변심 환불 기준은 서비스 정책을 따릅니다.</p>
                    <ul>
                        <li>콘텐츠 하자(파일 오류, 내용 누락 등)로 인한 환불 요청 발생 시</li>
                        <li>작가님께 연락드릴 수 있으며 수정·재업로드를 요청드릴 수 있습니다. </li>
                        <li>명백한 허위 정보·과장된 내용이 확인될 경우 판매가 제한될 수 있습니다.</li>
                    </ul>
                    <h4>4️. 구매자 커뮤니케이션</h4>
                    <p>유료 콘텐츠는 무료 게시물보다 독자의 문의가 더 많이 발생할 수 있습니다.</p>
                    <ul>
                        <li>댓글 또는 메시지를 통해 소통하는 경우, 가능하면 친절하고 일관성 있는 답변을 부탁드립니다.</li>
                        <li>악성 댓글·스팸 대응은 운영팀이 함께 도와드립니다.</li>
                    </ul>
                    <h4>5️. 불건전·제재 콘텐츠 기준 (반드시 확인)</h4>
                    <p>다음에 해당할 경우 유료 발행이 제한됩니다.</p>
                    <ul>
                        <li>저작권 위반, 표절 의혹</li>
                        <li>과도한 성인 콘텐츠, 도박, 혐오성 내용</li>
                        <li>사실과 다른 정보로 구매를 유도하는 행위</li>
                        <li>스팸성 콘텐츠(짧고 가치 없는 내용으로 결제 유도 등)</li>
                    </ul>
                </div>
            </div>
            <div class="modal-footer">
                <div class="footer-message">
                    <i class="fa-solid fa-crown crown-icon"></i> “유료 콘텐츠는 작가님의 브랜드입니다”
                </div>
                <p>유료 발행은 단순한 판매 기능이 아니라<br><strong>작가님의 전문성·경험·가치를 증명하는 브랜드 구축 과정</strong>입니다.</p>
                <p class="sub-text">서비스는 작가님이 안정적으로 창작 활동을 할 수 있도록 최선을 다해 지원하겠습니다.</p>
            </div>
        </div>
    </div>

    <div th:replace="~{common/footer :: footer}"></div>

    <script src="https://uicdn.toast.com/editor/latest/toastui-editor-all.min.js"></script>

    <script th:src="@{/js/common/header.js}"></script>
    <script th:src="@{/js/notification/noti.js}"></script>

    <script th:src="@{/js/board/blog/blogWrite.js}"></script>
</body>

</html>